<!DOCTYPE html>
<html>
<head>
  <title>RT Messaging Bridge</title>
  <script src="https://cdn.jsdelivr.net/npm/backendless@7/dist/backendless.min.js"></script>
</head>
<body>
  <h2>Listening for messages...</h2>

  <script>
    const APP_ID = "9561383D-4BC2-F4F1-FF73-B529BFE77000";
    const API_KEY = "BEE4A193-7ADC-419B-9EB4-202FDA99ACC6"; // Read-only Messaging Key
    const PUBLISHER_OBJECT_ID = "236E3176-6F40-BBB6-FF42-5D0E7E2F2300";
    const CHANNEL_NAME = PUBLISHER_OBJECT_ID.substring(0, 6);

    // Initialize
    Backendless.initApp(APP_ID, API_KEY);

    // Subscribe
    const channel = Backendless.Messaging.subscribe(CHANNEL_NAME);
    channel.addMessageListener((message) => {
      const msgText = typeof message === "object" ? JSON.stringify(message) : message;

      console.log("📩 Message received:", msgText);

      // 🔁 Send to Thunkable app (Web Bridge)
      window.ReactNativeWebView?.postMessage(msgText);
    });

    console.log("✅ Subscribed to channel:", CHANNEL_NAME);
  </script>
</body>
</html>
